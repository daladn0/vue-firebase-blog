"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[802],{5802:function(e,t,r){r.r(t),r.d(t,{default:function(){return H}});var n=r(6252),i=r(9963),u=r(3577),s={key:1},a=["src"],o=(0,n.Uk)("submit"),l={class:"block w-full text-red-500 mt-1 font-semibold"},c={class:"flex items-center"},d=["src"],m={class:"relative"},f={class:"text-red-500 mt-1 absolute left-0 top-full font-semibold"},p={key:1,class:"text-lg text-gray-800 font-semibold ml-2"},h={class:"flex items-center"},g=(0,n._)("h2",{class:"text-2xl text-black"},"Reset password",-1),b={class:"relative"},v=(0,n._)("label",{for:"user-email",class:"block mb-2"},"Your email address:",-1),w={class:"text-sm text-red-500"},y={class:"flex items-center"},k=(0,n.Uk)("Send reset link"),_=(0,n.Uk)("Discard");r(4916),r(7941),r(2526),r(7327),r(1539),r(5003),r(4747),r(9337);var P=r(588),x={class:"p-2 rounded-full flex items-center justify-center bg-gray-300 transition-all hover:bg-gray-350"},O={class:"w-6 h-6 text-gray-800 transition-all",viewBox:"0 0 20 20"},N=["xlink:href"],U={name:"ProfileButton",props:["icon"]},S=r(3744),I=(0,S.Z)(U,[["render",function(e,t,r,i,u,s){return(0,n.wg)(),(0,n.iD)("button",x,[((0,n.wg)(),(0,n.iD)("svg",O,[(0,n._)("use",{"xlink:href":"sprite.svg#".concat(r.icon)},null,8,N)]))])}]]),j=r(3516),M=r(989),C=r(2954),E=r(9501);function W(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function L(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?W(Object(r),!0).forEach((function(t){V(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):W(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function V(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var D={name:"Profile",components:{ProfileButton:I,Form:C.l0,Field:C.gN,Modal:j.Z},data:function(){var e=this;return{showModal:!1,editMode:!1,userEmail:"",userName:"",userPicture:"",userPictureInput:"",userNameValidation:(0,E.Z_)().test("same-user-name","User name is the same as before",(function(t){return t!==e.user.displayName})).required("User name can't be empty!"),userImageValidation:(0,E.Z_)().required("You've to provide an image url!"),userEmailValidation:(0,E.Z_)().required("Email is empty!").email("Email isn't valid!").test("email-invalid","You have to provide your email!",(function(t){return t===e.user.email}))}},computed:L({},(0,M.Se)("auth",["user","isDataLoading","isLoggedIn"])),methods:L(L(L({},(0,M.nv)("toast",["SHOW_ERROR","SHOW_SUCCESS"])),(0,M.nv)("auth",["updateUserName","updateUserImage","sendPasswordResetLink","logout"])),{},{sendEmailLink:function(){this.sendPasswordResetLink(),this.logout(),this.SHOW_SUCCESS("Check your email"),this.$router.push("/login")},enableEditMode:function(){var e=this;this.editMode=!0,setTimeout((function(){e.$refs["user-name-input"].focus()}),0)},saveNameChanges:function(){this.editMode=!1,this.updateUserName(this.userName)},discardNameChanges:function(){this.userName=this.user.displayName,this.editMode=!1},setUserPicture:function(){this.userPicture=this.userPictureInput,this.userPictureInput="",this.showModal=!1},changeUserImage:function(){this.userPicture!==this.user.photoURL&&this.updateUserImage(this.userPicture)},invalidImageHandle:function(){this.userPicture=this.user.photoURL,this.SHOW_ERROR("You've provided invalid image url!")},signOut:P.w7}),watch:{user:function(e){this.isLoggedIn&&e.displayName&&(this.userName=e.displayName,this.userPicture=e.photoURL)},showModal:function(e){var t=this;e&&setTimeout((function(){t.$refs["user-image-input"].focus()}),0)}},created:function(){this.isLoggedIn&&(this.userName=this.user.displayName,this.userPicture=this.user.photoURL)}};const R=(0,S.Z)(D,[["render",function(e,t,r,P,x,O){var N=(0,n.up)("Spinner"),U=(0,n.up)("FieldInput"),S=(0,n.up)("MainButton"),I=(0,n.up)("Field"),j=(0,n.up)("Form"),M=(0,n.up)("Modal"),C=(0,n.up)("ProfileButton"),E=(0,n.up)("router-link");return e.isDataLoading||!e.user?((0,n.wg)(),(0,n.j4)(N,{key:0,class:"mx-auto mt-5"})):((0,n.wg)(),(0,n.iD)("div",s,[(0,n._)("img",{class:"absolute invisible opacity-0 pointer-events-none",src:x.userPicture,onError:t[0]||(t[0]=function(){return O.invalidImageHandle&&O.invalidImageHandle.apply(O,arguments)}),onLoad:t[1]||(t[1]=function(){return O.changeUserImage&&O.changeUserImage.apply(O,arguments)}),alt:""},null,40,a),x.showModal?((0,n.wg)(),(0,n.j4)(M,{key:0,onClose:t[3]||(t[3]=function(e){return x.showModal=!1}),onKeyup:t[4]||(t[4]=(0,i.D2)((function(e){return x.showModal=!1}),["esc"]))},{default:(0,n.w5)((function(){return[(0,n.Wm)(j,{onSubmit:O.setUserPicture},{default:(0,n.w5)((function(){return[(0,n.Wm)(I,{name:"user-image",rules:x.userImageValidation},{default:(0,n.w5)((function(e){var r=e.field,i=e.errors;return[(0,n._)("div",null,[(0,n.Wm)(U,(0,n.dG)(r,{ref:"user-image-input",modelValue:x.userPictureInput,"onUpdate:modelValue":t[2]||(t[2]=function(e){return x.userPictureInput=e}),placeholder:"Image URL",class:"w-96 mr-4 py-2"}),null,16,["modelValue"]),(0,n.Wm)(S,{type:"submit"},{default:(0,n.w5)((function(){return[o]})),_:1})]),(0,n._)("span",l,(0,u.zw)(i[0]),1)]})),_:1},8,["rules"])]})),_:1},8,["onSubmit"])]})),_:1})):(0,n.kq)("v-if",!0),(0,n.Wm)(j,{onSubmit:O.saveNameChanges,onInvalidSubmit:t[7]||(t[7]=function(t){return e.$refs["user-name-input"].focus()}),class:"flex items-center justify-between"},{default:(0,n.w5)((function(){return[(0,n._)("div",c,[(0,n._)("div",{onClick:t[5]||(t[5]=function(e){return x.showModal=!0}),class:"w-28 h-28 rounded-full overflow-hidden mr-2 p-0.5 border-2 border-gray-400 cursor-pointer"},[(0,n._)("img",{class:"w-full h-full rounded-full object-cover",src:x.userPicture,alt:""},null,8,d)]),x.editMode?((0,n.wg)(),(0,n.j4)(I,{key:0,name:"user-name",rules:x.userNameValidation},{default:(0,n.w5)((function(r){var s=r.field,a=r.errors;return[(0,n._)("div",m,[(0,n.Wm)(U,(0,n.dG)(s,{ref:"user-name-input",class:"py-1 text-lg",modelValue:x.userName,"onUpdate:modelValue":t[6]||(t[6]=function(e){return x.userName=e}),placeholder:e.user.displayName,onKeyup:(0,i.D2)(O.discardNameChanges,["esc"])}),null,16,["modelValue","placeholder","onKeyup"]),(0,n._)("span",f,(0,u.zw)(a[0]),1)])]})),_:1},8,["rules"])):(0,n.kq)("v-if",!0),x.editMode?(0,n.kq)("v-if",!0):((0,n.wg)(),(0,n.iD)("p",p,(0,u.zw)(x.userName),1))]),(0,n._)("div",h,[x.editMode?((0,n.wg)(),(0,n.iD)(n.HY,{key:1},[(0,n.Wm)(C,{type:"submit",icon:"tick"}),(0,n.Wm)(C,{type:"button",icon:"close",class:"ml-2",onClick:O.discardNameChanges},null,8,["onClick"])],64)):((0,n.wg)(),(0,n.j4)(C,{key:0,type:"button",icon:"pen",onClick:O.enableEditMode},null,8,["onClick"]))])]})),_:1},8,["onSubmit"]),(0,n.Wm)(j,{onSubmit:O.sendEmailLink,onInvalidSubmit:t[9]||(t[9]=function(t){return e.$refs["user-email-input"].focus()}),class:"mt-8 mx-auto space-y-8"},{default:(0,n.w5)((function(){return[g,(0,n.Wm)(I,{name:"user-email",rules:x.userEmailValidation},{default:(0,n.w5)((function(e){var r=e.field,i=e.errors;return[(0,n._)("div",b,[v,(0,n.Wm)(U,(0,n.dG)({ref:"user-email-input",modelValue:x.userEmail,"onUpdate:modelValue":t[8]||(t[8]=function(e){return x.userEmail=e})},r,{id:"user-email",placeholder:"example@mail.com",class:"w-full py-2"}),null,16,["modelValue"]),(0,n._)("span",w,(0,u.zw)(i[0]),1)])]})),_:1},8,["rules"]),(0,n._)("div",y,[(0,n.Wm)(S,{type:"submit",class:"mr-4"},{default:(0,n.w5)((function(){return[k]})),_:1}),(0,n.Wm)(E,{to:"/",class:"text-white bg-red-500 hover:bg-red-600 focus:ring-4 focus:outline-none focus:ring-red-300 font-medium rounded-lg px-5 py-2.5 text-center"},{default:(0,n.w5)((function(){return[_]})),_:1})])]})),_:1},8,["onSubmit"])]))}]]);var H=R}}]);