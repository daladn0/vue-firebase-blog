"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[124],{2222:function(e,t,r){var o=r(2109),n=r(7854),i=r(7293),a=r(3157),s=r(111),c=r(7908),l=r(6244),u=r(6135),p=r(5417),d=r(1194),m=r(5112),f=r(7392),g=m("isConcatSpreadable"),y=9007199254740991,h="Maximum allowed index exceeded",b=n.TypeError,v=f>=51||!i((function(){var e=[];return e[g]=!1,e.concat()[0]!==e})),w=d("concat"),x=function(e){if(!s(e))return!1;var t=e[g];return void 0!==t?!!t:a(e)};o({target:"Array",proto:!0,arity:1,forced:!v||!w},{concat:function(e){var t,r,o,n,i,a=c(this),s=p(a,0),d=0;for(t=-1,o=arguments.length;t<o;t++)if(x(i=-1===t?a:arguments[t])){if(d+(n=l(i))>y)throw b(h);for(r=0;r<n;r++,d++)r in i&&u(s,d,i[r])}else{if(d>=y)throw b(h);u(s,d++,i)}return s.length=d,s}})},8124:function(e,t,r){r.r(t),r.d(t,{default:function(){return S}});var o=r(6252),n=r(9963),i=r(3577),a={key:1,class:"text-gray-700 text-center"},s={key:2,class:"max-w-xl mx-auto"},c=(0,o._)("label",{for:"email",class:"block mb-2 font-medium text-gray-900"},"Post title",-1),l=(0,o._)("label",{for:"email",class:"block mb-2 font-medium text-gray-900"},"Post description",-1),u={key:0,class:"text-red-500 text-sm"},p=(0,o._)("label",{class:"block mb-2 font-medium text-gray-900"},"Post picture url",-1),d={class:"flex items-center justify-between space-x-4"},m=(0,o.Uk)(" Submit "),f={key:0,class:"relative"},g=["src"],y=[(0,o._)("svg",{viewBox:"0 0 20 20",class:"w-5 h-5 text-white"},[(0,o._)("use",{"xlink:href":"/sprite.svg#close"})],-1)],h=["src"];r(2222),r(2526),r(1817),r(7941),r(7327),r(1539),r(5003),r(4747),r(9337),r(8674),r(2165),r(6992),r(8783),r(3948),r(1038),r(7042),r(8309),r(4916),r(5666);var b=r(2954),v=r(989),w=r(9501);function x(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function I(e,t,r,o,n,i,a){try{var s=e[i](a),c=s.value}catch(e){return void r(e)}s.done?t(c):Promise.resolve(c).then(o,n)}function P(e){return function(){var t=this,r=arguments;return new Promise((function(o,n){var i=e.apply(t,r);function a(e){I(i,o,n,a,s,"next",e)}function s(e){I(i,o,n,a,s,"throw",e)}a(void 0)}))}}function k(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,o)}return r}function _(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?k(Object(r),!0).forEach((function(t){C(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):k(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function C(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var O={name:"Create Post",components:{Form:b.l0,Field:b.gN},data:function(){return{action:"create",isLoading:!1,categories:[],postTitle:"",postDescription:"",selectedCategory:"disabled-option",postImage:"",imageURL:"",showImage:!1,descriptionValidation:(0,w.Z_)().required("Post description can't be empty!"),initialValues:{}}},methods:_(_(_(_({},(0,v.nv)("categories",["fetchCategories","fetchCategoryByID"])),(0,v.nv)("posts",["createPost","fetchSinglePostByID","updatePost"])),(0,v.nv)("toast",["SHOW_ERROR","SHOW_SUCCESS"])),{},{setImage:function(){this.invalidURL=!1,this.postImage=this.imageURL},createNewPost:function(){var e=this;return P(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLoading=!0,r="disabled-option"===e.selectedCategory?"":e.selectedCategory,t.next=4,e.createPost({title:e.postTitle,description:e.postDescription,photoURL:e.postImage,category_id:r});case 4:e.postImage="",e.imageURL="",e.postTitle="",e.postDescription="",e.selectedCategory="disabled-option",e.$router.push("/"),e.isLoading=!1;case 11:case"end":return t.stop()}}),t)})))()},editPost:function(){var e=this;return P(regeneratorRuntime.mark((function t(){var r;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLoading=!0,r="disabled-option"===e.selectedCategory?"":e.selectedCategory,t.next=4,e.updatePost({id:e.$route.params.id,title:e.postTitle,description:e.postDescription,category_id:r,photoURL:e.postImage});case 4:e.SHOW_SUCCESS("Post has been updated"),e.$router.push("/"),e.isLoading=!1;case 7:case"end":return t.stop()}}),t)})))()},checkImageValidation:function(){this.postImage&&(this.postImage="",this.imageURL="",this.showImage=!1,this.SHOW_ERROR("Invalid image url!"))},removeImage:function(){this.postImage="",this.imageURL="",this.showImage=!1}}),created:function(){var e=this;return P(regeneratorRuntime.mark((function t(){var r,o,n,i,a,s;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.invalidPost=!1,e.isLoading=!0,t.next=4,e.fetchCategories();case 4:if(e.categories=t.sent,e.action="update"===e.$route.meta.action?"update":"create","update"!==e.action){t.next=26;break}return e.categories=[{id:"",title:"No category"}].concat(function(e){if(Array.isArray(e))return x(e)}(c=e.categories)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(c)||function(e,t){if(e){if("string"==typeof e)return x(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?x(e,t):void 0}}(c)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),t.next=10,e.fetchSinglePostByID(e.$route.params.id);case 10:if(r=t.sent){t.next=15;break}return e.invalidPost=!0,e.isLoading=!1,t.abrupt("return");case 15:if(o=r.title,n=r.description,i=r.photoURL,!(a=r.category_id)){t.next=21;break}return t.next=19,e.fetchCategoryByID(a);case 19:(s=t.sent)&&(e.selectedCategory=s.id);case 21:i&&(e.postImage=i,e.showImage=!0),e.postTitle=o,e.postDescription=n,e.initialValues.postDescription=n,e.imageURL=i;case 26:return t.next=28,e.createPost({title:"asdasd",description:"asdasd",photoURL:"",category_id:"Yrbs9aI0zj06Awzm5r5p"});case 28:return t.next=30,t.sent;case 30:e.isLoading=!1;case 31:case"end":return t.stop()}var c}),t)})))()}};const R=(0,r(3744).Z)(O,[["render",function(e,t,r,b,v,w){var x=(0,o.up)("Spinner"),I=(0,o.up)("FieldInput"),P=(0,o.up)("Field"),k=(0,o.up)("Selection"),_=(0,o.up)("MainButton"),C=(0,o.up)("Form");return v.isLoading?((0,o.wg)(),(0,o.j4)(x,{key:0,class:"mx-auto mt-4"})):e.invalidPost?((0,o.wg)(),(0,o.iD)("p",a,"Such a post doesn't exist!")):((0,o.wg)(),(0,o.iD)("div",s,[(0,o.Wm)(C,{onSubmit:t[9]||(t[9]=function(e){return"update"===v.action?w.editPost():w.createNewPost()}),onInvalidSubmit:t[10]||(t[10]=function(t){return e.$refs["post-description"].focus()}),class:"space-y-8","initial-values":v.initialValues},{default:(0,o.w5)((function(){return[(0,o._)("div",null,[c,(0,o.Wm)(I,{modelValue:v.postTitle,"onUpdate:modelValue":t[0]||(t[0]=function(e){return v.postTitle=e}),modelModifiers:{lazy:!0},class:"w-full py-2.5",placeholder:"Post Title"},null,8,["modelValue"])]),(0,o._)("div",null,[(0,o.Wm)(P,{rules:v.descriptionValidation,name:"postDescription"},{default:(0,o.w5)((function(e){var r=e.field,a=e.errors;return[l,(0,o.wy)((0,o._)("textarea",(0,o.dG)({ref:"post-description"},r,{"onUpdate:modelValue":t[1]||(t[1]=function(e){return v.postDescription=e}),class:"w-full py-2 transition-all px-2 outline-none border border-gray-300 hover:border-gray-400 focus:border-gray-500 rounded-lg resize-none",placeholder:"Post Description"}),null,16),[[n.nr,v.postDescription]]),a[0]?((0,o.wg)(),(0,o.iD)("span",u,(0,i.zw)(a[0]),1)):(0,o.kq)("v-if",!0)]})),_:1},8,["rules"])]),(0,o._)("div",null,[(0,o._)("label",{for:"email",class:"block mb-2 font-medium text-gray-900",onClick:t[2]||(t[2]=function(){return e.ss&&e.ss.apply(e,arguments)})},"Post category"),(0,o.Wm)(k,{modelValue:v.selectedCategory,"onUpdate:modelValue":t[3]||(t[3]=function(e){return v.selectedCategory=e}),disabledOption:"Choose category",options:v.categories,"value-field":"id"},null,8,["modelValue","options"])]),(0,o._)("div",null,[p,(0,o._)("div",d,[(0,o.Wm)(I,{modelValue:v.imageURL,"onUpdate:modelValue":t[4]||(t[4]=function(e){return v.imageURL=e}),class:"w-full py-2.5",placeholder:"example.com/picture.png"},null,8,["modelValue"]),(0,o.Wm)(_,{type:"button",onClick:t[5]||(t[5]=function(e){return v.postImage=v.imageURL})},{default:(0,o.w5)((function(){return[m]})),_:1})]),v.showImage?((0,o.wg)(),(0,o.iD)("div",f,[(0,o._)("img",{class:"w-full h-full mt-8 aspect-video object-cover",src:v.postImage,alt:""},null,8,g),(0,o._)("button",{onClick:t[6]||(t[6]=function(){return w.removeImage&&w.removeImage.apply(w,arguments)}),class:"absolute top-1 right-1 transform -translate-y-1/2 translate-x-1/2 p-1 rounded-full bg-red-500 transition-all hover:bg-red-600 text-white"},y)])):(0,o.kq)("v-if",!0),(0,o._)("img",{onLoad:t[7]||(t[7]=function(e){return v.showImage=!0}),onError:t[8]||(t[8]=function(){return w.checkImageValidation&&w.checkImageValidation.apply(w,arguments)}),src:v.postImage,class:"absolute opacity-0 invisible pointer-events-none z-[-1] w-0 h-0",alt:""},null,40,h)]),(0,o.Wm)(_,{type:"submit"},{default:(0,o.w5)((function(){return[(0,o.Uk)((0,i.zw)("update"===v.action?"Update post":"Create Post"),1)]})),_:1})]})),_:1},8,["initial-values"])]))}]]);var S=R}}]);