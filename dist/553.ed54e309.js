"use strict";(self.webpackChunkblog=self.webpackChunkblog||[]).push([[553],{8553:function(e,t,a){a.r(t),a.d(t,{default:function(){return Le}});var r=a(6252),o=a(3577),n=a(9963),s={class:"p-4"},i={class:"text-2xl mb-8"},l=(0,r.Uk)(" Do you really want to remove "),c={class:"font-semibold"},g=(0,r.Uk)(" category? "),u={class:"flex justify-center items-center space-x-4"},d=(0,r.Uk)(" Remove "),m=(0,r._)("svg",{class:"w-5 h-5 text-white ml-2"},[(0,r._)("use",{"xlink:href":"/sprite.svg#tick"})],-1),y=(0,r.Uk)(" Cancel "),p=(0,r._)("svg",{class:"w-5 h-5 text-white ml-2"},[(0,r._)("use",{"xlink:href":"/sprite.svg#close"})],-1),f={key:2},h=["src"],w=(0,r._)("h3",{class:"text-2xl text-left font-semibold mb-6"},"Add category",-1),C={class:"mb-8"},b=(0,r._)("label",{class:"block mb-2.5"},"New category title: ",-1),v={class:"text-sm text-red-500 mt-1"},_=(0,r._)("label",{class:"block mb-2.5"},"New category img:",-1),x={class:"flex items-center space-x-4"},k=(0,r.Uk)("add photo"),I={class:"text-sm text-red-500 mt-1"},S={key:1,class:"w-full aspect-video mt-8"},R=["src"],L=(0,r.Uk)("Create category"),P=["src"],U=(0,r._)("h3",{class:"text-2xl text-left font-semibold mb-6"},"Update category",-1),O={key:0,class:"mt-8 space-y-8"},T=(0,r._)("label",{class:"block mb-2.5"},"Selected category title:",-1),W=(0,r._)("label",{class:"block mb-2.5"},"New category img:",-1),N={class:"flex items-center space-x-4"},V=(0,r.Uk)("add photo"),D={key:1,class:"mt-8 w-full aspect-video"},E=["src"],j={class:"flex items-center"},M=(0,r.Uk)("Update category"),A=(0,r.Uk)("Remove category");a(5666),a(4916),a(1539),a(4747),a(9826),a(7941),a(2526),a(7327),a(5003),a(9337),a(8674);var z=a(989),H=a(2954),q=a(9501),F=a(3516),B={key:0,class:"text-gray-700 mt-5 mx-auto text-center"},Z={key:1,class:"relative"},Y={class:"flex items-center absolute right-full top-0 mr-4"},$=(0,r._)("p",{class:"font-medium whitespace-nowrap mr-2"},"Items amount: ",-1),G={class:"w-full text-sm text-left text-gray-500 table-fixed"},K=(0,r._)("thead",{class:"text-xs text-gray-700 uppercase bg-gray-200 border border-gray-300 border-b"},[(0,r._)("tr",null,[(0,r._)("th",{class:"w-14 p-4"},"â„–"),(0,r._)("th",{class:"w-4/12 p-4"},"Post title"),(0,r._)("th",{class:"w-2/12 p-4"},"Image"),(0,r._)("th",{class:"w-2/12 p-4"},"Category"),(0,r._)("th",{class:"w-3/12 p-4"},"Date"),(0,r._)("th",{class:"w-1/12 p-4"},[(0,r._)("span",{class:"sr-only"},"Edit")])])],-1),J={class:"border border-gray-300 border-t-0"},Q={class:"p-4 truncate"},X={class:"p-4 font-medium whitespace-nowrap truncate"},ee={key:0,class:"text-gray-900 truncate"},te={key:1},ae={class:"p-4"},re={key:0,class:"w-full aspect-video"},oe=["src"],ne={key:1},se={class:"p-4 truncate"},ie={class:"p-4"},le={class:"p-4 text-center"},ce=(0,r.Uk)("Open");a(7042);var ge=[{id:1,title:"10"},{id:2,title:"25"},{id:3,title:"50"}],ue=a(7712),de={class:"flex items-center -space-x-px"},me=[(0,r._)("svg",{class:"w-5",viewBox:"0 0 20 20"},[(0,r._)("use",{"xlink:href":"/sprite.svg#arrow-left2"})],-1)],ye=["onClick"],pe=[(0,r._)("svg",{class:"w-5",viewBox:"0 0 20 20"},[(0,r._)("use",{"xlink:href":"/sprite.svg#arrow-right"})],-1)],fe={name:"Pagination",props:["totalPages","currentPage"],methods:{goBack:function(){1!==this.currentPage&&this.$emit("togglePage",this.currentPage-1)},goForward:function(){this.currentPage!==this.totalPages&&this.$emit("togglePage",this.currentPage+1)}}},he=a(3744);const we=(0,he.Z)(fe,[["render",function(e,t,a,n,s,i){return(0,r.wg)(),(0,r.iD)("nav",null,[(0,r._)("ul",de,[(0,r._)("li",null,[(0,r._)("button",{class:(0,o.C_)(["block py-2 px-3 ml-0 leading-tight text-gray-500 bg-white rounded-l-lg border border-gray-300 hover:bg-gray-100 hover:text-gray-700",{"opacity-20 pointer-events-none":1===a.currentPage}]),onClick:t[0]||(t[0]=function(){return i.goBack&&i.goBack.apply(i,arguments)})},me,2)]),((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(a.totalPages,(function(t){return(0,r.wg)(),(0,r.iD)("li",{key:t},[(0,r._)("button",{class:(0,o.C_)(["py-2 px-3 leading-tight text-gray-500 border border-gray-300",[a.currentPage===t?"bg-gray-200":"bg-white hover:bg-gray-100 hover:text-gray-700"]]),onClick:function(a){return e.$emit("togglePage",t)}},(0,o.zw)(t),11,ye)])})),128)),(0,r._)("li",null,[(0,r._)("button",{class:(0,o.C_)(["block py-2 px-3 leading-tight text-gray-500 bg-white rounded-r-lg border border-gray-300 hover:bg-gray-100 hover:text-gray-700",{"opacity-20 pointer-events-none":a.currentPage===a.totalPages}]),onClick:t[1]||(t[1]=function(){return i.goForward&&i.goForward.apply(i,arguments)})},pe,2)])])])}]]);var Ce={name:"CategoriesTable",components:{Pagination:we},props:{posts:{type:Array,default:function(){return[]}},currentCategory:{type:Object}},data:function(){return{currentPage:1,postsToShow:[],selectedAmount:ge[0].title,SELECTION_ITEMS_AMOUNT:ge}},computed:{totalPostsCount:function(){return this.posts.length},totalPagesCount:function(){return Math.ceil(this.totalPostsCount/this.selectedAmount)}},methods:{setPostsToShow:function(){var e=this,t=this.posts.slice((this.currentPage-1)*this.selectedAmount);this.postsToShow=t.filter((function(t,a){return a<e.selectedAmount}))},formatDate:ue.p6},watch:{selectedAmount:function(){this.currentPage=1,this.setPostsToShow()},currentPage:function(){this.setPostsToShow()}},mounted:function(){this.setPostsToShow()}},be=(0,he.Z)(Ce,[["render",function(e,t,a,n,s,i){var l=(0,r.up)("Selection"),c=(0,r.up)("router-link"),g=(0,r.up)("Pagination");return(0,r.wg)(),(0,r.iD)("div",null,[a.posts&&0!==a.posts.length?((0,r.wg)(),(0,r.iD)("div",Z,[(0,r._)("div",Y,[$,(0,r.Wm)(l,{class:"w-fit pr-8 flex-shrink-0 cursor-pointer",modelValue:s.selectedAmount,"onUpdate:modelValue":t[0]||(t[0]=function(e){return s.selectedAmount=e}),options:s.SELECTION_ITEMS_AMOUNT,valueField:"title"},null,8,["modelValue","options"])]),(0,r._)("table",G,[K,(0,r._)("tbody",J,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(s.postsToShow,(function(e,t){return(0,r.wg)(),(0,r.iD)("tr",{key:e.id,class:"bg-white border-b hover:bg-gray-300"},[(0,r._)("th",Q,(0,o.zw)(t+1),1),(0,r._)("th",X,[e.title?((0,r.wg)(),(0,r.iD)("p",ee,(0,o.zw)(e.title),1)):((0,r.wg)(),(0,r.iD)("p",te,"[ No title ]"))]),(0,r._)("td",ae,[e.photoURL?((0,r.wg)(),(0,r.iD)("div",re,[(0,r._)("img",{src:e.photoURL},null,8,oe)])):((0,r.wg)(),(0,r.iD)("p",ne,"[ No image ]"))]),(0,r._)("td",se,[(0,r.Wm)(c,{class:"hover:underline",to:"/categories/".concat(a.currentCategory.title)},{default:(0,r.w5)((function(){return[(0,r.Uk)((0,o.zw)(a.currentCategory.title),1)]})),_:1},8,["to"])]),(0,r._)("td",ie,(0,o.zw)(i.formatDate(e.timestamp.seconds)),1),(0,r._)("td",le,[(0,r.Wm)(c,{to:"/post/".concat(e.id),class:"font-medium text-blue-600 hover:underline"},{default:(0,r.w5)((function(){return[ce]})),_:2},1032,["to"])])])})),128))])]),(0,r.Wm)(g,{class:"flex items-center justify-center mx-auto mt-8",totalPages:i.totalPagesCount,currentPage:s.currentPage,onTogglePage:t[1]||(t[1]=function(e){return s.currentPage=e})},null,8,["totalPages","currentPage"])])):((0,r.wg)(),(0,r.iD)("p",B," This category has no posts "))])}]]);function ve(e,t,a,r,o,n,s){try{var i=e[n](s),l=i.value}catch(e){return void a(e)}i.done?t(l):Promise.resolve(l).then(r,o)}function _e(e){return function(){var t=this,a=arguments;return new Promise((function(r,o){var n=e.apply(t,a);function s(e){ve(n,r,o,s,i,"next",e)}function i(e){ve(n,r,o,s,i,"throw",e)}s(void 0)}))}}function xe(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function ke(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?xe(Object(a),!0).forEach((function(t){Ie(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):xe(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function Ie(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var Se={name:"ManageCategories",components:{Form:H.l0,Field:H.gN,Modal:F.Z,CategoriesTable:be},data:function(){var e=this;return{showModal:!1,categories:[],posts:[],isLoading:!1,postsLoading:!1,isImageLoading:!1,selectedCategory:"disabled-option",selectedCategoryTitle:"",selectedCategoryImage:"",selectedCategoryImageURL:"",isSelectedImageLoading:!1,newCategoryTitle:"",newCategoryImage:"",newCategoryImageURL:"",categoryTitleValidation:(0,q.Z_)().required("Category title is required!").test("already-exists","Such a category already exists",(function(t){var a=!0;return e.categories.forEach((function(e){e.title===t&&(a=!1)})),a})),categoryImageURLValidation:(0,q.Z_)().required("Category image is required!"),showNewCategoryImage:!1}},methods:ke(ke(ke(ke({},(0,z.nv)("posts",["fetchPostsByCategory"])),(0,z.nv)("toast",["SHOW_ERROR","CLEAR_TOASTS","SHOW_SUCCESS"])),(0,z.nv)("categories",["createCategory","fetchCategories","removeCategory","updateCategory"])),{},{createNewCategory:function(){var e=this;return _e(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.newCategoryImage){t.next=4;break}return e.CLEAR_TOASTS(),e.SHOW_ERROR("Invalid image url!"),t.abrupt("return");case 4:return e.isLoading=!0,t.next=7,e.createCategory({title:e.newCategoryTitle,photoURL:e.newCategoryImage});case 7:return t.next=9,e.fetchCategories();case 9:e.categories=t.sent,e.SHOW_SUCCESS("Category is added"),e.newCategoryTitle="",e.newCategoryImage="",e.newCategoryImageURL="",e.showNewCategoryImage=!1,e.isLoading=!1;case 16:case"end":return t.stop()}}),t)})))()},deleteSelectedCategory:function(){var e=this;return _e(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.selectedCategory&&"disabled-option"!==e.selectedCategory){t.next=3;break}return e.SHOW_ERROR("You've not choosen category yet."),t.abrupt("return");case 3:return e.isLoading=!0,t.next=6,e.removeCategory({id:e.selectedCategory});case 6:return t.next=8,e.fetchCategories();case 8:e.categories=t.sent,e.selectedCategory="disabled-option",e.SHOW_SUCCESS("Category is deleted!"),e.isLoading=!1;case 12:case"end":return t.stop()}}),t)})))()},setNewCategoryImage:function(){this.newCategoryImageURL&&(this.isImageLoading=!0,this.newCategoryImage=this.newCategoryImageURL)},checkNewCategoryImage:function(){this.newCategoryImage&&(this.newCategoryImage="",this.newCategoryImageURL="",this.showNewCategoryImage=!1,this.SHOW_ERROR("Invalid image url!"),this.isImageLoading=!1)},loadNewCategoryImage:function(){this.CLEAR_TOASTS(),this.showNewCategoryImage=!0,this.isImageLoading=!1},selectCategory:function(e){var t=this.categories.find((function(t){return t.id===e})),a=t.title,r=t.photoURL;this.selectedCategoryImage=r,this.selectedCategoryImageURL=r,this.selectedCategoryTitle=a},setSelectedCategoryImage:function(){this.isSelectedImageLoading=!0,this.selectedCategoryImage=this.selectedCategoryImageURL},checkSelectedImageValidation:function(){var e=this;if(this.selectedCategory&&"disabled-option"!==this.selectedCategory){var t=this.categories.find((function(t){return t.id===e.selectedCategory})).photoURL;this.selectedCategoryImage=t,this.selectedCategoryImageURL=t,this.SHOW_ERROR("Invalid image url"),this.isSelectedImageLoading=!1}},updateSelectedCategory:function(){var e=this;return _e(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e.selectedCategory&&"disabled-option"!==e.selectedCategory){t.next=3;break}return e.SHOW_ERROR("You've not choosen a category"),t.abrupt("return");case 3:return e.isLoading=!0,t.next=6,e.updateCategory({id:e.selectedCategory,title:e.selectedCategoryTitle,photoURL:e.selectedCategoryImage});case 6:return t.next=8,e.fetchCategories();case 8:e.categories=t.sent,e.SHOW_SUCCESS("Category is updated"),e.isLoading=!1;case 11:case"end":return t.stop()}}),t)})))()},changeSelectedImage:function(){this.selectedCategoryImage=this.selectedCategoryImageURL,this.isSelectedImageLoading=!1}}),computed:{currentCategory:function(){var e=this;return this.categories.find((function(t){return t.id===e.selectedCategory}))||null}},watch:{selectedCategory:function(e){var t=this;return _e(regeneratorRuntime.mark((function a(){return regeneratorRuntime.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if("disabled-option"===e){a.next=6;break}return t.postsLoading=!0,a.next=4,t.fetchPostsByCategory(t.selectedCategory);case 4:t.posts=a.sent,t.postsLoading=!1;case 6:case"end":return a.stop()}}),a)})))()}},created:function(){var e=this;return _e(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.isLoading=!0,t.next=3,e.fetchCategories();case 3:e.categories=t.sent,e.isLoading=!1;case 5:case"end":return t.stop()}}),t)})))()}};const Re=(0,he.Z)(Se,[["render",function(e,t,a,z,H,q){var F=(0,r.up)("MainButton"),B=(0,r.up)("Modal"),Z=(0,r.up)("Spinner"),Y=(0,r.up)("FieldInput"),$=(0,r.up)("Field"),G=(0,r.up)("Form"),K=(0,r.up)("Selection"),J=(0,r.up)("CategoriesTable");return(0,r.wg)(),(0,r.iD)(r.HY,null,[H.showModal?((0,r.wg)(),(0,r.j4)(B,{key:0},{default:(0,r.w5)((function(){return[(0,r._)("div",s,[(0,r._)("p",i,[l,(0,r._)("span",c,(0,o.zw)(H.selectedCategoryTitle),1),g]),(0,r._)("div",u,[(0,r.Wm)(F,{type:"button",class:"flex items-center",onClick:t[0]||(t[0]=function(e){q.deleteSelectedCategory(),H.showModal=!1})},{default:(0,r.w5)((function(){return[d,m]})),_:1}),(0,r.Wm)(F,{type:"button",class:"bg-red-500 hover:bg-red-600 flex items-center focus:ring-0",onClick:t[1]||(t[1]=function(e){return H.showModal=!1})},{default:(0,r.w5)((function(){return[y,p]})),_:1})])])]})),_:1})):(0,r.kq)("v-if",!0),H.isLoading?((0,r.wg)(),(0,r.j4)(Z,{key:1,class:"mx-auto mt-5"})):((0,r.wg)(),(0,r.iD)("div",f,[(0,r.kq)(" Add category "),(0,r.Wm)(G,{onSubmit:q.createNewCategory,class:"flex flex-col bg-white p-8 rounded-lg shadow-md"},{default:(0,r.w5)((function(){return[(0,r._)("img",{src:H.newCategoryImage,onLoad:t[2]||(t[2]=function(){return q.loadNewCategoryImage&&q.loadNewCategoryImage.apply(q,arguments)}),onError:t[3]||(t[3]=function(){return q.checkNewCategoryImage(e.handleReset)}),class:"w-0 h-0 absolute z-[-1] opacity-0 invisible pointer-events-none"},null,40,h),w,(0,r.Wm)($,{value:H.newCategoryTitle,rules:H.categoryTitleValidation,name:"newCategoryTitle"},{default:(0,r.w5)((function(e){var a=e.field,n=e.errors;return[(0,r._)("div",C,[b,(0,r.Wm)(Y,(0,r.dG)({modelValue:H.newCategoryTitle,"onUpdate:modelValue":t[4]||(t[4]=function(e){return H.newCategoryTitle=e}),modelModifiers:{lazy:!0}},a,{class:"py-2 w-full",placeholder:"New category title"}),null,16,["modelValue"]),(0,r._)("span",v,(0,o.zw)(n[0]),1)])]})),_:1},8,["value","rules"]),(0,r.Wm)($,{name:"newCategoryImageURLValidation",rules:H.categoryImageURLValidation},{default:(0,r.w5)((function(e){var a=e.errors,n=e.field;return[(0,r._)("div",null,[_,(0,r._)("div",x,[(0,r.Wm)(Y,(0,r.dG)(n,{value:H.newCategoryImageURL,modelValue:H.newCategoryImageURL,"onUpdate:modelValue":t[5]||(t[5]=function(e){return H.newCategoryImageURL=e}),modelModifiers:{lazy:!0},class:"py-2 w-full",placeholder:"New category image"}),null,16,["value","modelValue"]),(0,r.Wm)(F,{type:"button",onClick:q.setNewCategoryImage,class:"flex-shrink-0"},{default:(0,r.w5)((function(){return[k]})),_:1},8,["onClick"])]),(0,r._)("span",I,(0,o.zw)(a[0]),1)])]})),_:1},8,["rules"]),H.isImageLoading?((0,r.wg)(),(0,r.j4)(Z,{key:0,class:"mx-auto mt-8"})):H.showNewCategoryImage?((0,r.wg)(),(0,r.iD)("div",S,[(0,r._)("img",{class:"w-full h-full object-cover",src:H.newCategoryImage,alt:""},null,8,R)])):(0,r.kq)("v-if",!0),(0,r.Wm)(F,{type:"submit",class:"w-fit mt-8"},{default:(0,r.w5)((function(){return[L]})),_:1})]})),_:1},8,["onSubmit"]),(0,r.kq)(" Update Category "),(0,r._)("form",{onSubmit:t[12]||(t[12]=(0,n.iM)((function(){return q.updateSelectedCategory&&q.updateSelectedCategory.apply(q,arguments)}),["prevent"])),class:"flex flex-col bg-white p-8 rounded-lg shadow-md mt-8"},[(0,r._)("img",{class:"w-0 h-0 absolute z-[-1] opacity-0 invisible pointer-events-none",src:H.selectedCategoryImage,onError:t[6]||(t[6]=function(){return q.checkSelectedImageValidation&&q.checkSelectedImageValidation.apply(q,arguments)}),onLoad:t[7]||(t[7]=function(){return q.changeSelectedImage&&q.changeSelectedImage.apply(q,arguments)})},null,40,P),U,(0,r.Wm)(K,{"onUpdate:modelValue":[q.selectCategory,t[8]||(t[8]=function(e){return H.selectedCategory=e})],modelValue:H.selectedCategory,options:H.categories,valueField:"id",disabledOption:"Choose category"},null,8,["onUpdate:modelValue","modelValue","options"]),H.selectedCategory&&"disabled-option"!==H.selectedCategory?((0,r.wg)(),(0,r.iD)("div",O,[(0,r._)("div",null,[T,(0,r.Wm)(Y,{modelValue:H.selectedCategoryTitle,"onUpdate:modelValue":t[9]||(t[9]=function(e){return H.selectedCategoryTitle=e}),modelModifiers:{lazy:!0},class:"py-2 w-full",placeholder:"Selected category title"},null,8,["modelValue"])]),(0,r._)("div",null,[W,(0,r._)("div",N,[(0,r.Wm)(Y,{modelValue:H.selectedCategoryImageURL,"onUpdate:modelValue":t[10]||(t[10]=function(e){return H.selectedCategoryImageURL=e}),modelModifiers:{lazy:!0},class:"py-2 w-full",placeholder:"New category image"},null,8,["modelValue"]),(0,r.Wm)(F,{type:"button",onClick:q.setSelectedCategoryImage,class:"flex-shrink-0"},{default:(0,r.w5)((function(){return[V]})),_:1},8,["onClick"])])]),H.isSelectedImageLoading?((0,r.wg)(),(0,r.j4)(Z,{key:0,class:"mx-auto mt-5"})):((0,r.wg)(),(0,r.iD)("div",D,[(0,r._)("img",{class:"w-full h-full object-cover",src:H.selectedCategoryImage},null,8,E)]))])):(0,r.kq)("v-if",!0),(0,r._)("div",j,[(0,r.Wm)(F,{class:"mt-8",type:"submit"},{default:(0,r.w5)((function(){return[M]})),_:1}),(0,r.Wm)(F,{class:"mt-8 bg-red-500 hover:bg-red-600 ml-4 focus:ring-0",type:"button",onClick:t[11]||(t[11]=function(e){return H.showModal=!0})},{default:(0,r.w5)((function(){return[A]})),_:1})])],32),H.selectedCategory&&"disabled-option"!==H.selectedCategory&&!H.postsLoading?((0,r.wg)(),(0,r.j4)(J,{key:0,posts:H.posts,currentCategory:q.currentCategory,class:"mt-8"},null,8,["posts","currentCategory"])):(0,r.kq)("v-if",!0)]))],64)}]]);var Le=Re}}]);